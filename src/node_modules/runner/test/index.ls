require! {
	'../callback'
	'../report'
}

{Callback} = callback
{Report} = report



export class Test
	(input) ~>
		spec = input ? {}

		# ----------------------------------------------------------------------

		{name} = spec
		name ?= ''
		@ <<< {name}

		# ----------------------------------------------------------------------

		{execution} = spec
		execution = new Callback execution
		@ <<< {execution}

		# ----------------------------------------------------------------------

		{
			validation
			exception
			value
		} = spec
		if typeof validation isnt 'Function'
			validation = if exception
				({exception}) -> exception?
			else
				({output}) -> output is value
		@ <<< {validation}

	run: (logger) ->
		try output = @execution.run!
		catch exception =>

		report = new Report @validation {
			input: @execution{args, thisArg}
			output
			exception
		}

		report.display logger
